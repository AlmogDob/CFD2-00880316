\documentclass[11pt, a4paper]{article}
\usepackage{amsmath, amssymb, titling}
\usepackage[margin=3cm]{geometry}

\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

\title{Computational Fluid Dynamics}
\author{Almog Dobrescu\\\\ID 214254252}

\begin{document}

\maketitle

\thispagestyle{empty}
\newpage
\setcounter{page}{1}

\tableofcontents
\newpage

\section{Mathematical Problem}
The Burgers Equation:
\begin{equation}
    \frac{\partial u}{\partial t} + u\frac{\partial u}{\partial y} = \frac{\partial}{\partial y}\left(\mu\frac{\partial u}{\partial y}\right)
\end{equation}
By neglection the convective term, the parabolic model equation is obtained:
\begin{align}
    \frac{\partial u}{\partial t} &= \frac{\partial}{\partial y}\left(\mu\frac{\partial u}{\partial y}\right)\\
    \frac{\partial u}{\partial t} &= \mu\frac{\partial^2 u}{\partial y^2}\\
    \mu &= 1.0
\end{align}
Boundary and initial conditions:
\begin{equation}
    u_{(y_0, t)} = u_0 \hspace{1cm} u_{(y_1, t)} = u_1 \hspace{1cm} u_{(y, t=0)} = f_{(y)}
\end{equation}

\section{Numerical Scheme}
A general explicit-implicit scheme for constant $\mu$ is given by:
\begin{equation}
    u^{n+1}_i = u^n_i + \frac{\mu\Delta t}{\Delta y^2}\delta_{yy}\left[\left(1-\alpha\right)u^n_i+\alpha u^{n+1}_i\right]
\end{equation}
where:
\begin{equation}
    \alpha = \left\{\begin{matrix}
        0 & \text{Explicit}\\
        \frac{1}{2} & \text{Crank-Nicolson}\\
        1 & \text{Implicit}
    \end{matrix}\right.
\end{equation}
and the order is:
\begin{equation}
    \left[\Delta x^2, \Delta\left(\frac{1}{2}-\alpha\right)\right]
\end{equation}
In delta form:
\begin{equation}
    \left(I-\alpha\frac{\mu\Delta t}{\Delta y^2}\delta_{yy}\right)\Delta u^n_i = \frac{\mu\Delta t}{\Delta y^2}\delta_{yy}u^n_i
\end{equation}
Applying the operators:
\begin{align}
    \Delta u^n_i - \alpha\frac{\mu\Delta t}{\Delta y^2}\delta_{yy}\left(\Delta u^n_i\right) &= \frac{\mu\Delta t}{\Delta y^2}\delta_{yy}\left(u^n_i\right)\\
    \Delta u^n_i - \alpha\frac{\mu\Delta t}{\Delta y^2}\delta_{y}\left(\Delta u^n_{\left(y_i+\frac{\Delta y}{2}\right)} - \Delta u^n_{\left(y_i-\frac{\Delta y}{2}\right)}\right) &= \frac{\mu\Delta t}{\Delta y^2}\delta_{y}\left(u^n_{\left(y_i+\frac{\Delta y}{2}\right)} - u^n_{\left(y_i-\frac{\Delta y}{2}\right)}\right)\\
    \Delta u^n_i - \alpha\frac{\mu\Delta t}{\Delta y^2}\left(\scriptstyle\Delta u^n_{\left(y_i+\Delta y\right)} - 2\Delta u^n_{\left(y_i\right)} + \Delta u^n_{\left(y_i - \Delta y\right)}\right) &= \frac{\mu\Delta t}{\Delta y^2}\left(\scriptstyle u^n_{\left(y_i+\Delta y\right)} - 2u^n_{\left(y_i\right)} + u^n_{\left(y_i-\Delta y\right)}\right)\\
    \Delta u^n_i - \alpha\frac{\mu\Delta t}{\Delta y^2}\left(\Delta u^n_{i+1}-2\Delta u^n_i + \Delta u^n_{i-1}\right) &= \frac{\mu\Delta t}{\Delta y^2}\left(u^n_{i+1} - 2u^n_{i} + u^n_{i-1}\right)\\
    A_i\Delta u^n_{i-1}+B_i\Delta u^n_i+C_i\Delta u^n_{i+1} &= D_i
\end{align}
where:
\begin{align}
    A_i &= - \alpha\frac{\mu\Delta t}{\Delta y^2}\\
    B_i &= 1 + 2 \alpha\frac{\mu\Delta t}{\Delta y^2}\\
    C_i &= - \alpha\frac{\mu\Delta t}{\Delta y^2}\\
    D_i &= \frac{\mu\Delta t}{\Delta y^2}\left(u^n_{i+1} - 2u^n_{i} + u^n_{i-1}\right)
\end{align}
and
\begin{equation}
    u^{n+1}_i = u^n_i + \Delta u^n_i
\end{equation}
In matrix from:
\begin{equation}
    \begin{pmatrix}
        B_1 & C_1 & 0 & \cdots & \cdots & \cdots & 0 \\
        A_2 & B_2 & C_2 & 0 & \cdots & \cdots & 0 \\
        0 & \ddots & \ddots & \ddots & 0 & \cdots & 0 \\
        0 & 0 & A_i & B_i & C_i & 0 & 0 \\
        0 & \cdots & 0 & \ddots & \ddots & \ddots & 0 \\
        0 & \cdots & \cdots & 0 & A_{N-2} & B_{N-2} & C_{N-2} \\
        0 & 0 & \cdots & \cdots & 0 & A_{N-1} &B_{N-1}
    \end{pmatrix}
    \begin{pmatrix}
        \Delta u_1\\
        \Delta u_2\\
        \cdots\\
        \cdots\\
        \cdots\\
        \Delta u_{N-2}\\
        \Delta u_{N-1}
    \end{pmatrix}
    =
    \begin{pmatrix}
        D_1-A_1\cdot u_0\\
        D_2\\
        \cdots\\
        \cdots\\
        \cdots\\
        D_{N-2}\\
        D_{N-1}-C_{N-1}\cdot u_N
    \end{pmatrix}
\end{equation}
To reduce problems of big flouting point numbers, define \emph{r}:
\begin{equation}
    r \triangleq \frac{\mu\Delta t}{\Delta y^2}
\end{equation}
After dividing by \emph{r}:
\begin{align}
    A_i &= - \alpha\\
    B_i &= \frac{1}{r} + 2 \alpha\\
    C_i &= - \alpha\\
    D_i &= \left(u^n_{i+1} - 2u^n_{i} + u^n_{i-1}\right)
\end{align}
In our case:
\begin{equation}
    y_0 = 0 \hspace{1cm}
    u_0 = 0 \hspace{1cm}
    y_1 = 1 \hspace{1cm}
    u_1 = 1 \hspace{1cm}
    f_{(y)} = 1
\end{equation}
\newpage

\section{Stability Analysis}
According to the "von Neumann Stability Analysis", the error between the differential and numerical equation is given by:
\begin{equation}
    \varepsilon = N-D
\end{equation}
where:
\begin{equation}
    \varepsilon(y,t)=\sum_{m}c_m(t)e^{ik_my}
\end{equation}
since the analysis is linear, one can choose one element from the series. Morover, the error becomes:
\begin{equation}
    \varepsilon^n=Z^ne^{iky}
\end{equation}
The constant"\emph{k}" is the wave number theat is related to the initial error.
\begin{equation}
    Z=e^{\lambda\Delta t} \Rightarrow Z^n = e^{\lambda n\Delta t} = e^{\lambda t}
\end{equation}
Any element of the error therefore takes the form:
\begin{equation}
    \varepsilon^n = e^{\lambda  t}e^{iky}
\end{equation}
The ratio between consecutive errors is the \emph{amplification factor}, names "\emph{G}":
\begin{equation}
    G \triangleq \frac{\varepsilon^{n+1}}{\varepsilon^n} = e^{\lambda\Delta t}
\end{equation}
The condition for Stability:
\begin{equation}
    |G| < 1
\end{equation}
The error must satisfies the finite difference equation:
\begin{equation}
    \Delta \varepsilon^n_i - \alpha\frac{\mu\Delta t}{\Delta y^2}\left(\Delta \varepsilon^n_{i+1}-2\Delta \varepsilon^n_i + \Delta \varepsilon^n_{i-1}\right) = \frac{\mu\Delta t}{\Delta y^2}\left(\varepsilon^n_{i+1} - 2\varepsilon^n_{i} + \varepsilon^n_{i-1}\right)
\end{equation}
Where:
\begin{align}
    \Delta\varepsilon^n_i = \varepsilon^{n+1}_i - \varepsilon^n_i &=e^{\lambda\left(t+\Delta t\right)}e^{iky} - e^{\lambda t}e^{iky} = e^{\lambda t}e^{iky}\left(e^{\lambda\Delta t}-1\right)\\
    \Delta\varepsilon^n_{i+1} = \varepsilon^{n+1}_{i+1} - \varepsilon^n_{i+1} &= e^{\lambda\left(t+\Delta t\right)}e^{ik\left(y+\Delta y\right)} - e^{\lambda t}e^{ik\left(y+\Delta y\right)} = e^{\lambda t}e^{ik\left(y+\Delta y\right)}\left(e^{\lambda\Delta t}-1\right)\\
    \Delta\varepsilon^n_{i-1} = \varepsilon^{n+1}_{i-1} - \varepsilon^n_{i-1} &= e^{\lambda\left(t+\Delta t\right)}e^{ik\left(y-\Delta y\right)} - e^{\lambda t}e^{ik\left(y-\Delta y\right)} = e^{\lambda t}e^{ik\left(y-\Delta y\right)}\left(e^{\lambda\Delta t}-1\right)
\end{align}
Substitut the values:
\begin{equation}
    \begin{matrix}
        \displaystyle\left(e^{\lambda t}e^{iky} - \alpha\frac{\mu\Delta t}{\Delta y^2}\left(e^{\lambda t}e^{ik\left(y+\Delta y\right)} - 2e^{\lambda t}e^{iky} + e^{\lambda t}e^{ik\left(y-\Delta y\right)}\right)\right)\left(e^{\lambda\Delta t}-1\right) =\\
        \displaystyle= \frac{\mu\Delta t}{\Delta y^2}\left(e^{\lambda t}e^{ik\left(y+\Delta y\right)} - 2e^{\lambda t}e^{iky} + e^{\lambda t}e^{ik\left(y-\Delta y\right)}\right)
    \end{matrix}
\end{equation}
Dividing by $e^{\lambda t}e^{iky}$:
\begin{equation}
    \left(1-\alpha\frac{\mu\Delta t}{\Delta y^2}\left(e^{ik\Delta y} -2 + e^{-ik\Delta y}\right)\right)\left(e^{\lambda t}-1\right) = \frac{\mu\Delta t}{\Delta y^2}\left(e^{ik\Delta y} -2 + e^{-ik\Delta y}\right)
\end{equation}
Define:
\begin{equation}
    \begin{matrix}
        \displaystyle r \triangleq \frac{\mu\Delta t}{\Delta y^2}, &\displaystyle A \triangleq e^{ik\Delta y}-2+e^{ik\Delta y}=2\cos\beta-2, & \displaystyle \beta \triangleq k\Delta y
    \end{matrix}
\end{equation}
After substitution and rearranging we get:
\begin{equation}
    e^{\lambda t}-1 = \frac{rA}{1-\alpha rA}
\end{equation}
$$\Downarrow$$
\begin{equation}
    G = e^{\lambda t} = 1+\frac{rA}{1-\alpha rA}
\end{equation}
For stability:
\begin{equation}
    |G|<1 \Rightarrow \left|1+\frac{rA}{1-\alpha rA}\right| < 1
\end{equation}
% \begin{equation}
%     -1<\frac{1-4r(1-\alpha)}{1+4r\alpha}<1
% \end{equation}
% \begin{align}
%     -1<\frac{1-4r(1-\alpha)}{1+4r\alpha} \hspace{0.5cm}\emph{and}&\hspace{0.5cm} \frac{1-4r(1-\alpha)}{1+4r\alpha}<1\\
%     \frac{1-4r(r-\alpha)+1+4r\alpha}{1+4r\alpha}>0 \hspace{0.5cm}\emph{and}&\hspace{0.5cm} \frac{1-4r(1-\alpha)-1-4r\alpha}{1+4r\alpha}<0\\
%     2-4r^2+8r\alpha = 0 \hspace{0.5cm} 1+4r\alpha\neq 0 \hspace{0.5cm}\emph{and}&\hspace{0.5cm} -4r\alpha = 0 \hspace{0.5cm} 1+4r\alpha \neq 0
% \end{align}
For $\alpha = 0$:
\begin{gather}
    G = 1+rA\\
    \left|1-4r\right| < 1\\
    -1< 1-4r <1\\
    -2< -4r <0\\
    0< 4r <2\\
    0< r <\frac{1}{2}\\
    \Delta t < \frac{\Delta y^2}{2\mu}
\end{gather}
For $\alpha = 1$:
\begin{gather}
    G = \frac{1}{1-rA}\\
    \begin{matrix}
        \displaystyle\left|\frac{1}{1-rA}\right|<1 & A \leq 0
    \end{matrix}
\end{gather}
$$\Downarrow$$
\begin{center}
    smaller for every \emph{r} ($\Delta t$)
\end{center}
For every $\alpha$ and $\Delta t\rightarrow\infty$:
\begin{equation}
    \lim_{\Delta t\rightarrow\infty}\left|G\right|=\frac{1-\alpha}{\alpha}
\end{equation}
Which means that stability for infinite time step:
\begin{equation}
    \alpha \left\{\begin{matrix}
        \displaystyle<\frac{1}{2} & \text{Unstable} \\\\
        \displaystyle=\frac{1}{2} & \text{Neutrally stable} \\\\
        \displaystyle>\frac{1}{2} & Stable
    \end{matrix}\right.
\end{equation}



\newpage

\section{The Computer Program}
\newpage

\section{Results}
\newpage

\section{Conclusions}
\newpage

\end{document}
